---
subcategory: "Web Application Acceleration and Security"
layout: "oci"
page_title: "Oracle Cloud Infrastructure: oci_waas_custom_protection_rules"
sidebar_current: "docs-oci-datasource-waas-custom_protection_rules"
description: |-
  Provides the list of Custom Protection Rules in Oracle Cloud Infrastructure Web Application Acceleration and Security service
---

# Data Source: oci_waas_custom_protection_rules
This data source provides the list of Custom Protection Rules in Oracle Cloud Infrastructure Web Application Acceleration and Security service.

Gets a list of custom protection rules for the specified Web Application Firewall.

## Example Usage

```hcl
data "oci_waas_custom_protection_rules" "test_custom_protection_rules" {
	#Required
	compartment_id = "${var.compartment_id}"

	#Optional
	display_names = "${var.custom_protection_rule_display_names}"
	ids = "${var.custom_protection_rule_ids}"
	states = "${var.custom_protection_rule_states}"
	time_created_greater_than_or_equal_to = "${var.custom_protection_rule_time_created_greater_than_or_equal_to}"
	time_created_less_than = "${var.custom_protection_rule_time_created_less_than}"
}
```

## Argument Reference

The following arguments are supported:

* `compartment_id` - (Required) The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the compartment. This number is generated when the compartment is created.
* `display_names` - (Optional) Filter custom protection rules using a list of display names.
* `ids` - (Optional) Filter custom protection rules using a list of custom protection rule OCIDs.
* `states` - (Optional) Filter Custom Protection rules using a list of lifecycle states.
* `time_created_greater_than_or_equal_to` - (Optional) A filter that matches Custom Protection rules created on or after the specified date-time.
* `time_created_less_than` - (Optional) A filter that matches custom protection rules created before the specified date-time.


## Attributes Reference

The following attributes are exported:

* `custom_protection_rules` - The list of custom_protection_rules.

### CustomProtectionRule Reference

The following attributes are exported:

* `compartment_id` - The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the custom protection rule's compartment.
* `defined_tags` - Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Operations.CostCenter": "42"}` 
* `description` - The description of the custom protection rule.
* `display_name` - The user-friendly name of the custom protection rule.
* `freeform_tags` - Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Department": "Finance"}` 
* `id` - The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the custom protection rule.
* `mod_security_rule_ids` - The auto-generated ID for the custom protection rule. These IDs are referenced in logs.
* `state` - The current lifecycle state of the custom protection rule.
* `template` - The template text of the custom protection rule. All custom protection rules are expressed in ModSecurity Rule Language.

	Additionally, each rule must include two placeholder variables that are updated by the WAF service upon publication of the rule.

	`id: {{id_1}}` - This field is populated with a unique rule ID generated by the WAF service which identifies a `SecRule`. More than one `SecRule` can be defined in the `template` field of a CreateCustomSecurityRule call. The value of the first `SecRule` must be `id: {{id_1}}` and the `id` field of each subsequent `SecRule` should increase by one, as shown in the example.

	`ctl:ruleEngine={{mode}}` - The action to be taken when the criteria of the `SecRule` are met, either `OFF`, `DETECT` or `BLOCK`. This field is automatically populated with the corresponding value of the `action` field of the `CustomProtectionRuleSetting` schema when the `WafConfig` is updated.

	*Example:* ``` SecRule REQUEST_COOKIES "regex matching SQL injection - part 1/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 1/2.',        \ id: {{id_1}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" SecRule REQUEST_COOKIES "regex matching SQL injection - part 2/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 2/2.',        \ id: {{id_2}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" ```

	 The example contains two `SecRules` each having distinct regex expression to match the `Cookie` header value during the second input analysis phase.

	For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/tasks/customprotectionrules.htm).

	For more information about ModSecurity syntax, see [Making Rules: The Basic Syntax](https://www.modsecurity.org/CRS/Documentation/making.html).

	For more information about ModSecurity's open source WAF rules, see [Mod Security's OWASP Core Rule Set documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
* `time_created` - The date and time the protection rule was created, expressed in RFC 3339 timestamp format.

